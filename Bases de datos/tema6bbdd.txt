
SELECT APELLIDO, OFICIO, SALARIO, FECHAALT FROM EMPLE 
WHERE OFICIO =(SELECT OFICIO FROM EMPLE WHERE APELLIDO='JIMENEZ')
OR SALARIO>=(SELECT SALARIO FROM EMPLE WHERE APELLIDO ='FERNANDEZ');



SELECT APELLIDO, OFICIO, SALARIO, FECHAALT FROM EMPLE 
WHERE OFICIO =(SELECT OFICIO FROM EMPLE WHERE APELLIDO='JIMENEZ')
OR SALARIO>=(SELECT SALARIO FROM EMPLE WHERE APELLIDO ='FERNANDEZ');


SELECT APELLIDO, OFICIO, SALARIO, FECHAALT FROM EMPLE 
WHERE (OFICIO =(SELECT OFICIO FROM EMPLE WHERE APELLIDO='JIMENEZ')
OR SALARIO>=(SELECT SALARIO FROM EMPLE WHERE APELLIDO ='FERNANDEZ'))
AND APELLIDO NOT IN ('JIMENEZ','FERNANDEZ');

SELECT APELLIDO FROM EMPLE
WHERE OFICIO IN (SELECT OFICIO FROM EMPLE WHERE DEPTNO =20);

SELECT APELLIDO FROM EMPLE
WHERE EXISTS (SELECT * FROM EMPLE
WHERE APELLIDO LIKE '%LUCAS%');


SELECT APELLIDO FROM EMPLE
WHERE EXISTS (SELECT * FROM EMPLE
WHERE APELLIDO LIKE '%ARROYO%');


SELECT APELLIDO FROM EMPLE
WHERE  NOT EXISTS (SELECT * FROM EMPLE
WHERE APELLIDO LIKE '%LUCAS%');



SELECT * FROM EMPLE 
WHERE SALARIO = ANY (SELECT SALARIO FROM EMPLE
WHERE DEPTNO = 30);



SELECT * FROM EMPLE 
WHERE SALARIO < ALL (SELECT SALARIO FROM EMPLE 
WHERE DEPTNO = 30);



SELECT APELLIDO 
FROM EMPLE WHERE OFICIO = (SELECT OFICIO FROM EMPLE WHERE APELLIDO = 'GIL')
AND APELLIDO <> 'GIL';
select * from emple where deptno in (select deptno from depart where loc in ('madrid','barcelona'));



select apellido, oficio, from emple where deptno = 20 and oficio=any[in](select oficio from emple where deptno=(select deptno from depart where dnombre ="ventas"));




SELECT APELLIDO FROM EMPLE 
WHERE (OFICIO, SALARIO) = (SELECT OFICIO,SALARIO FROM EMPLE 
WHERE APELLIDO = 'GIL') AND APELLIDO <> 'GIL';



SELECT APELLIDO, OFICIO, SALARIO FROM EMPLE 
WHERE (DEPTNO, SALARIO) = (SELECT DEPTNO, SALARIO FROM EMPLE
WHERE APELLIDO='FERNANDEZ')
AND APELLIDO <> 'FERNANDEZ';





SELECT APELLIDO from EMPLE E
where SALARIO = ( select MAX(SALARIO) from EMPLE
where DEPTNO= E.DEPTNO);

SELECT APELLIDO from EMPLE E
where SALARIO > ( select avg(SALARIO) from EMPLE
where DEPTNO= E.DEPTNO);



SELECT * FROM EMPLE E WHERE FECHAALT=(SELECT MIN(FECHAALT) FROM EMPLE WHERE DEPTNO=E.DEPTNO);



--NUMERO DE EMPLEADOS POR CADA DEP
SELECT DEPTNO , COUNT(EMPNO) FROM EMPLE
GROUP BY DEPTNO;

--num emple/oficio

SELECT OFICIO, COUNT (EMPNO)
FROM EMPLE 
GROUP BY OFICIO
ORDER BY 1 ;



SELECT OFICIO, DEPTNO, COUNT (EMPNO)
FROM EMPLE 
GROUP BY OFICIO, DEPTNO
ORDER BY 1 ;




TODOS LOS CAMPOS DEL SELECT TIENEN QUE ESTAR EN EL GROUP BY SINO NO FUNCIONA O ESTAR DENTRO DE COUNT U OTRO TIPO DE AGRUPACION(MAX,MIN, SUB)

HAVING


SELECT DEPTNO, MAX(SALARIO)
FROM EMPLE
GROUP BY DEPTNO
HAVING MAX(sALARIO)>2500;


SELECT OFICIO,COUNT (EMPNO)
FROM EMPLE
GROUP BY OFICIO
HAVING COUNT (EMPNO)>3;


SELECT OFICIO,COUNT (EMPNO)
FROM EMPLE
WHERE APELLIDO NOT LIKE 'A%'
GROUP BY OFICIO
HAVING COUNT (EMPNO)>2;


SELECT DEPTNO ,COUNT (EMPNO)
FROM EMPLE
GROUP BY DEPTNO
HAVING COUNT (*)>4;


SELECT DEPTNO, ROUND( AVG(SALARIO))
FROM EMPLE E
GROUP BY DEPTNO
HAVING AVG(SALARIO)>=( SELECT  AVG (SALARIO ) FROM EMPLE);



SELECT DEPTNO, SUM (SALARIO) "SALARIO SUMADO",
MAX (SALARIO) " SALARIO MAXIMO ", MIN (SALARIO), 
ROUND (AVG(SALARIO),2)  "SALARIO MEDIO" 
FROM EMPLE GROUP BY DEPTNO;




SELECT max(COUNT(EMPNO))
FROM EMPLE 
GROUP BY DEPTNO;



SELECT DEPTNO, COUNT (*)
FROM EMPLE 
GROUP BY DEPTNO
HAVING COUNT (*)=(SELECT MAX(COUNT (*))FROM EMPLE GROUP BY DEPTNO);


SELECT DNOMBRE
FROM DEPART
WHERE DEPTNO IN( SELECT DEPTNO 
FROM EMPLE 
GROUP BY DEPTNO
HAVING COUNT (*)>4);

SELECT DNOMBRE 
FROM DEPART 
WHERE  (DEPTNO)IN
(SELECT DEPTNO FROM EMPLE GROUP BY DEPTNO HAVING COUNT (EMPNO)=
(SELECT MAX(COUNT (EMPNO))FROM EMPLE GROUP BY DEPTNO));


SELECT APELLIDO 
FROM EMPLE
WHERE SALARIO = (SELECT MAX (SALARIO)FROM EMPLE);
